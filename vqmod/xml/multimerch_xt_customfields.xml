<?xml version="1.0" ?>
<!DOCTYPE modification [
<!ENTITY themeFolder "default">
]>
<modification>
	<id>MultiMerch Custom Seller Fields</id>
	<author>http://multimerch.com/</author>

	<file name="admin/model/multiseller/install.php">
		<operation>
			<search position="after"><![CDATA[
				`nickname` VARCHAR(32) NOT NULL DEFAULT '',
			]]></search>
			<add><![CDATA[
				`phone` VARCHAR(35) NOT NULL DEFAULT '',
			]]></add>
		</operation>
	</file>
	
	<file name="system/library/msseller.php">
		<operation>
			<search position="after"><![CDATA[
				ms.seller_id as 'seller_id',
			]]></search>
			<add><![CDATA[
				ms.phone as 'ms.phone',
			]]></add>
		</operation>

        <operation>
			<search position="after"><![CDATA[
				nickname = '" . $this->db->escape($data['nickname']) . "',
			]]></search>
			<add><![CDATA[
				phone = '" . (isset($data['phone']) ? $this->db->escape($data['phone']) : '') . "',
			]]></add>
		</operation>
	</file>
	
	<file path="catalog/view/theme/&themeFolder;/template/multiseller/account-profile.tpl">
		<operation error="skip">
			<search position="before" offset="1"><![CDATA[
			    <label class="col-sm-2 control-label"><?php echo $ms_account_sellerinfo_company; ?></label>
			]]></search>
			<add><![CDATA[
                <div class="form-group">
                    <label class="col-sm-2 control-label"><?php echo $ms_account_sellerinfo_phone; ?></label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control"  name="seller[phone]" value="<?php echo $seller['ms.phone']; ?>" />
                        <p class="ms-note"><?php echo $ms_account_sellerinfo_phone_note; ?></p>
                    </div>
                </div>
			]]></add>
		</operation>
	</file>

	<file name="catalog/language/english/multiseller/multiseller.php">
		<operation>
			<search position="before"><![CDATA[
				$_['ms_account_sellerinfo_company'] = 'Company';
			]]></search>
			<add><![CDATA[
                $_['ms_account_sellerinfo_phone'] = 'Phone';
                $_['ms_account_sellerinfo_phone_note'] = 'Your phone number (optional)';
                $_['ms_error_sellerinfo_phone_length'] = 'Phone number cannot be longer than 35 characters';
                $_['ms_catalog_seller_profile_phone'] = 'Phone:';
                $_['ms_catalog_seller_profile_company'] = 'Company:';
			]]></add>
		</operation>
	</file>

	<file name="catalog/controller/seller/account-profile.php">
		<operation>
			<search position="before"><![CDATA[
				if (mb_strlen($data['seller']['company']) > 50 ) {
			]]></search>
			<add><![CDATA[
                if (mb_strlen($data['seller']['phone']) > 35 ) {
                    $json['errors']['seller[phone]'] = $this->language->get('ms_error_sellerinfo_phone_length');
                }
			]]></add>
		</operation>
	</file>

	<file name="catalog/controller/seller/catalog-seller.php">
		<operation>
			<search position="before"><![CDATA[
				$this->data['seller']['nickname'] = $seller['ms.nickname'];
			]]></search>
			<add><![CDATA[
                $this->data['seller']['phone'] = $seller['ms.phone'];
			]]></add>
		</operation>
	</file>

	<file path="catalog/view/theme/&themeFolder;/template/multiseller/catalog-seller-profile.tpl">
		<operation error="skip">
			<search position="before"><![CDATA[
			    <?php if (isset($seller['company']) && $seller['company']) { ?><li><?php echo $ms_catalog_seller_profile_company; ?> <?php echo $seller['company']; ?></li><?php } ?>
			]]></search>
			<add><![CDATA[
                <?php if (isset($seller['phone']) && $seller['phone']) { ?><li><?php echo $ms_catalog_seller_profile_phone; ?> <?php echo $seller['phone']; ?></li><?php } ?>
			]]></add>
		</operation>
	</file>
</modification>
